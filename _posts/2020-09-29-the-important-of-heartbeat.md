---
layout: post
title:  "心跳机制的必要性"
date:   2020-09-29 18:49:13
categories: project-experience
tags: heartbeat
---

* content
{:toc}

心跳是用于判断是否掉线的，只要连着的时候就会持续每个一小会发一个心跳包，服务器如果多久没收到就判断你已经掉线了，之所以需要心跳包而不是直接判断socket的联通状态是因为在网络上有大量的连接缓存设备（如电信局的交换机、一些硬件防火墙），这些设备会保存连接一段时间（几秒到十几分钟都有）。
举个例子，A客户连着B服务器，但实际上是A->中间的网络设备C->B，如果A掉线了，实际上可能是A到C断了，也可能是C到B断了。如果是A到C断了，实际上B是无法知道的，因为B来说A的连接（就是C）还连着，心跳机制就解决了这个问题