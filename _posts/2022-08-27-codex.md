---
layout: post
title: "编码乱谈"
date: 2022-08-27 03:29:44
categories: program
tags: encode
---

* content
{:toc}

对于英语,其字符总数不超过256	
对于汉语,其字符总数远远超过256个.常见的思路为:对于汉语书写中出现的英语字符,比如大小写字母,符号等,使用一个不超过0x80的字节表示;对于汉字,使用多个连续的,取值大于0x80的字节表示.

GB2312能够表示常见的简体汉字,每个汉字占2个字节;
另一种汉字编码方案尾Big5,主要用来表示繁体汉字.
常见的英语字符也被纳入这些编码方案中,他们的编号余ASCII方案下的完全相同.
我们将这种一个字符可能对应一个或者多个字节的编码方案成为多字节编码(multibyte encoding).
[多字节编码使用较少的字节表示使用频率较高的字符,可以有效的降低保存字符的存储容量,常被用在文件系统,网络传输等场合.
但是对于计算机内部字符串处理,由于每个字符所占字节数不同,解析过程会降低运行速度.]

类似于以上汉语的编码思路,日语有JIS编码,其他自然语言也有着各自的编码方案.这些编码方案中,多数方案只表示一个自然语言中的字符,最好情形下也只能表示其他自然语言的少数字符
因而,每个方案在设计之初就没有考虑如何兼容其他自然语言的字符,导致不同的自然语言中的字符可能被映射为相同的字节序列.

当操作系统本身采用这种编码方式时,情况会变得更糟.
例如香港用户采用Big5编码的windows 95/98创建了一些文档,这些文档被传输到基于GB2312编码的windows平台时,却无法正常显示处理.


因此从xp时代开始,微软将编码方案从原来的多字节编码转换成了Unicode.


Unicode为世界上的各种语言的每个字符指定一个统一,唯一的编号.
但是将这个编号转换为字节序列时却有着不同的方案,从而形成不同的Unicode编码方案,
如UTF-8,UTF-16等.

UTF-8采用多字节编码,常用的英语字符采用1个字节表示,其他的字符采用2到4个字节表示.
UTF-16使用2个字节来表示常用字符,对于不常用的字符用4个字节来表示.

多字节编码方式使用较少的字节来表示使用频率较高的字符
对于频率很低的字符才会使用较多的字节，因而这种方式可以有效的降低保存字符的存储容量，常常被用在文件系统、网络传输

然而这种方式并不适用于计算机内部对字符串的处理。由于每个字符占用字节数不同，程序必须从第一个字符串首位字节开始解析以确定每个字符对应字节序列在内存中的位置，毫无疑问这个解析过程会极大的降低程序运行速度。如果采用多字节编码（比如utf-8）我们必须遍历整个字节流才能得到字符串包含多少个字符


为了提高字符串处理速度,计算机常采用固定长度的存储单元来存放每个字符.
使用Unicode存储的字符称为宽字符(wide characters).
采用这种存储方式，我们能够很容易地在一个字节流中定位每个字符的其实、终止位置，也能够轻易地求取一个字符串的字符个数。

ANSI原意是指美国国家标准协会,但是在windows系统中,ANSI编码意思却代表“本地编码”
也就是说，在中国代表GBK，在台湾代表Big5，在日本代表JIS，==>Multibyte
所以windows编程中常说的ANSI字符串，就是指本地编码的字符串，在中国，就是一种DBCS，用1个和2个字节表示一个字符的编码。